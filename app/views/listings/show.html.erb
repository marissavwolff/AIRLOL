<div class="container">


  <div class="card-product">
    <% if @listing.photo.attached? %>
      <%= cl_image_tag @listing.photo.key, height: 300, width: 400, crop: :fill %>
    <% else %>
      <%= image_tag "lauging-image.png", height: 300, width: 400, crop: :fill %>
    <% end %>
    <div class="card-product-infos">
      <h1><%= @listing.name %></h1>
        <h3><%= @listing.location %> | Â£<%= @listing.price %></h3>
        <h2 class="mp-5">Category: <%= @listing.category %></h2>
        <h3> </h3>
        <% if @listing.availability.present? %>
        <%= simple_form_for [@listing, @booking] do |f| %>
        <div>
          <%= f.input :date, as: :date, html5: true, label: false %>
        </div>
        <%= f.submit "Book this Humour!", class: "btn btn-flat" %>
        <% end %>
        <% else %>
      <strong><p>Sorry, this humour is not available</p></strong>
    <% end %>
    </div>
  </div>


  <div class="card-map">
    <div class="listing-description">
      <p><%= @listing.description %></p>
      <div class="mt-5">
        <h5>What this <%= @listing.category %> humour has to offer:</h5>
        <ul class="list-unstyled p-1">
          <li><i class="fa-regular fa-face-grin-squint-tears" style="rgb(,0,0)"></i>  Laugh till you cry</li>
          <li><i class="fa-solid fa-face-laugh-beam"></i>  Smile till your cheeks hurt</li>
          <li><i class="fa-regular fa-face-laugh-squint"></i>  Giggle like a kid again </li>
          <li><i class="fa-solid fa-square-person-confined"></i>  Some may question the type of humour</li>
          <li><i class="fa-solid fa-face-laugh-wink"></i>  But will always laugh out of pitty</li>
        </ul>
      </div>
    </div>
    <div style="width: 100%; height: 600px;"
      data-controller="map"
      data-map-marker-value="<%= @marker.to_json %>"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>





  <%# <div class="m-4">
    <%= link_to "Book this humour!", new_listing_booking_path(@listing), class: "btn btn-primary" %>
  <%# </div> %>

  <% if @listing.availability.present? %>
    <%= simple_form_for [@listing, @booking] do |f| %>
    <div class="col-2">
      <%= f.input :date, as: :date, html5: true%>
    </div>
    <%= f.submit "Book this Humour!", class: "custom-button-class" %>
    <% end %>
    <% else %>
  <strong><p>Sorry, this humour is not available</p></strong>
<% end %>


    </div>


  <%# <div class="m-4">
    <%= link_to "Book this humour!", new_listing_booking_path(@listing), class: "btn btn-primary" %>
  <%# </div> %>




 <p><strong>Reviews: </strong></p>

  <ul class="list-group">
    <% @listing.reviews.each do |review| %>
      <li class="list-group-item"><%= review.content %> |
      <% if review.rating == 1 then %><i class="fa-solid fa-star"></i><% end %><% if review.rating == 2 then %><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><% end %><% if review.rating == 3 then %><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><% end %><% if review.rating == 4 then %><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><% end %><% if review.rating == 5 then %><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><% end %></li>
    <% end %>
  </ul>
</div>
